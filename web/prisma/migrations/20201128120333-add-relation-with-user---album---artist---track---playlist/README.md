# Migration `20201128120333-add-relation-with-user---album---artist---track---playlist`

This migration has been generated by marulloc at 11/28/2020, 9:03:34 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE `Users_Like_Albums` DROP COLUMN `liked`,
    ADD COLUMN     `userId` INT,
    ADD COLUMN     `albumId` INT

ALTER TABLE `Users_Like_Artists` DROP COLUMN `liked`,
    ADD COLUMN     `userId` INT,
    ADD COLUMN     `artistId` INT

ALTER TABLE `Users_Like_Tracks` DROP COLUMN `liked`,
    ADD COLUMN     `userId` INT,
    ADD COLUMN     `trackId` INT

CREATE TABLE `Users_Likes_Playlists` (
    `id` INT NOT NULL AUTO_INCREMENT,
    `userId` INT,
    `playlistId` INT,

    PRIMARY KEY (`id`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

DROP TABLE `Users_Playlists`

ALTER TABLE `Users_Likes_Playlists` ADD FOREIGN KEY (`userId`) REFERENCES `Users`(`id`) ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE `Users_Likes_Playlists` ADD FOREIGN KEY (`playlistId`) REFERENCES `Playlists`(`id`) ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE `Users_Like_Albums` ADD FOREIGN KEY (`userId`) REFERENCES `Users`(`id`) ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE `Users_Like_Albums` ADD FOREIGN KEY (`albumId`) REFERENCES `Albums`(`id`) ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE `Users_Like_Artists` ADD FOREIGN KEY (`userId`) REFERENCES `Users`(`id`) ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE `Users_Like_Artists` ADD FOREIGN KEY (`artistId`) REFERENCES `Artists`(`id`) ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE `Users_Like_Tracks` ADD FOREIGN KEY (`userId`) REFERENCES `Users`(`id`) ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE `Users_Like_Tracks` ADD FOREIGN KEY (`trackId`) REFERENCES `Tracks`(`id`) ON DELETE SET NULL ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20201128115735-delete-create-at..20201128120333-add-relation-with-user---album---artist---track---playlist
--- datamodel.dml
+++ datamodel.dml
@@ -3,9 +3,9 @@
 }
 datasource db {
   provider = "mysql"
-  url = "***"
+  url = "***"
 }
 model Users {
   id        Int         @id @default(autoincrement())
@@ -188,25 +188,33 @@
 }
 model Users_Like_Albums {
   id        Int      @id @default(autoincrement())
-  liked     Boolean?
-
+  userId    Int?
+  albumId   Int?
+  Users     Users? @relation(fields: [userId], references: [id])
+  Albums    Albums? @relation(fields: [albumId], references: [id])
 }
 model Users_Like_Artists {
   id        Int      @id @default(autoincrement())
-  liked     Boolean?
-
+  userId    Int?
+  artistId   Int?
+  Users     Users? @relation(fields: [userId], references: [id])
+  Artists   Artists? @relation(fields: [artistId], references: [id])
 }
 model Users_Like_Tracks {
   id        Int      @id @default(autoincrement())
-  liked     Boolean?
-
+  userId    Int?
+  trackId   Int?
+  Users     Users? @relation(fields: [userId], references: [id])
+  Tracks    Tracks? @relation(fields: [trackId], references: [id])
 }
-model Users_Playlists {
+model Users_Likes_Playlists {
   id        Int       @id @default(autoincrement())
-  recent    DateTime?
-
+  userId    Int?
+  playlistId   Int?
+  Users     Users? @relation(fields: [userId], references: [id])
+  Playlists Playlists? @relation(fields: [playlistId], references: [id])
 }
```


